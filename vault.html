<!DOCTYPE html>
<html>
<head>
    <title>Titan Vault | Admin</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body { background: #000; color: #0f0; font-family: monospace; padding: 20px; }
        .log-card { border: 1px solid #333; margin-bottom: 25px; padding: 15px; background: #0a0a0a; border-radius: 5px; position: relative; }
        img { width: 100%; max-width: 400px; border: 1px solid #0f0; margin-top: 10px; }
        .meta { font-size: 0.8rem; color: #888; }
        .btn-group { margin-top: 10px; display: flex; gap: 10px; }
        .btn { padding: 5px 10px; border: 1px solid #0f0; color: #0f0; text-decoration: none; font-size: 0.7rem; cursor: pointer; background: transparent; }
        .del-btn { border-color: #ff4444; color: #ff4444; }
        .del-btn:hover { background: #ff4444; color: #fff; }
    </style>
</head>
<body>
    <h1>TITAN SECURE VAULT</h1>
    <div id="logs">SYNCING DATA...</div>

    <script>
        const API = "https://titan-logger.saliljha523.workers.dev";

        async function fetchLogs() {
            const res = await fetch(API);
            const data = await res.json();
            const container = document.getElementById('logs');
            
            if (data.length === 0) {
                container.innerHTML = "VAULT EMPTY.";
                return;
            }

            container.innerHTML = data.map(item => {
                const gps = item.location.split('GPS: ')[1];
                const mapsUrl = (gps && gps !== 'N/A') ? `https://www.google.com/maps?q=${gps}` : "#";

                return `
                    <div class="log-card" id="card-${item.id}">
                        <div class="meta">
                            ID: ${item.id} | ${new Date(item.timestamp).toLocaleString()}<br>
                            LOC: ${item.location}
                        </div>
                        <img src="${item.image}">
                        <div class="btn-group">
                            ${gps !== 'N/A' ? `<a href="${mapsUrl}" target="_blank" class="btn">GOOGLE MAPS</a>` : ''}
                            <button class="btn del-btn" onclick="deleteEntry(${item.id})">DELETE DATA</button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        async function deleteEntry(id) {
            if (!confirm("Permanently delete this entry?")) return;
            
            try {
                const res = await fetch(API, {
                    method: 'DELETE',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ id: id })
                });

                if (res.ok) {
                    document.getElementById(`card-${id}`).remove();
                }
            } catch (e) {
                alert("Delete failed: " + e.message);
            }
        }

        fetchLogs();
    </script>
</body>
</html>
